---
layout: single
title: è³‡å®‰å°Žè«–ç­†è¨˜
date: 2022-03-22 14:02:37
excerpt: NTUST è³‡è¨Šå®‰å…¨å°Žè«–ç­†è¨˜
categories:
- ç­†è¨˜
tags:
- æ¸¬è©¦
- ç­†è¨˜
- ç¨‹å¼
---
# è³‡å®‰å°Žè«–ç­†è¨˜  

# CH01 Introduction  

## è³‡å®‰ä¸‰è¦ç´  : CIA triad  
![](https://i.imgur.com/fr4Lclw.png =220x)
* ä¿å¯†æ€§ (Confidentiality)
ä¿è­·æ©Ÿå¯†è³‡æ–™ï¼Œé˜²æ­¢æœªæŽˆæ¬Šè³‡æ–™å¤–æ´©
æ”»æ“Šæ–¹æ³• : `ç«Šå–` `å·è½` `ç¤¾äº¤å·¥ç¨‹` ç­‰
* å®Œæ•´æ€§ (Integrity)
é¿å…è³‡æ–™åœ¨ä¸æ­£ç¢ºçš„ç‹€æ…‹ä¸‹è¢«ç«„æ”¹æ­éœ²ï¼Œex é¿å…é‡£é­šã€ç°½ç« 
æ”»æ“Šæ–¹æ³• : `ç«„æ”¹` `é‡£é­š` `åˆªé™¤æ©Ÿå¯†æª”æ¡ˆ`ç­‰
* å¯ç”¨æ€§ (Availability)
åŒæ™‚ç¢ºä¿è³‡æ–™èˆ‡ç³»çµ±åœ¨ä»»ä¸€æ™‚åˆ»éƒ½æ˜¯å¯é çš„ï¼Œex é¿å…ç³»çµ±å´©æ½°åŠè³‡æ–™æµå¤±
æ”»æ“Šæ–¹æ³• : `DOS` ç­‰

## OSI Security Architecture  
ä¸€å€‹ç”±åœ‹éš›æ¨™æº–çµ„ç¹”æ‰€åˆ¶è¨‚çš„å®‰å…¨ä½œæ¥­æ–¹æ³•  

* å®‰å…¨æ”»æ“Šï¼šä»»ä½•æ´©æ¼ä¼æ¥­è³‡è¨Šçš„è¡Œç‚ºã€‚
* å®‰å…¨æ©Ÿåˆ¶ï¼šç”¨ä¾†åµæ¸¬æˆ–é é˜²å®‰å…¨æ”»æ“Šï¼Œæˆ–è€…èƒ½å¤ å¾©åŽŸå®‰å…¨æ”»æ“Šçš„æ©Ÿåˆ¶ã€‚
* å®‰å…¨æœå‹™ï¼šèƒ½å¤ åŠ å¼·è³‡è¨Šå®‰å…¨çš„æœå‹™ï¼Œé€™äº›æœå‹™æ˜¯ç”±æ•¸ç¨®å®‰å…¨æ©Ÿåˆ¶æä¾›ã€‚ 

#### å®šç¾©  
> å¨è„…ï¼ˆThreatï¼‰ï¼šå¯èƒ½ç ´å£žç³»çµ±å®‰å…¨çš„æƒ…æ³ã€èƒ½åŠ›æˆ–è¡Œç‚ºã€‚
> æ”»æ“Šï¼ˆAttackï¼‰ï¼šåˆ©ç”¨å·²çŸ¥çš„æŠ€è¡“ï¼Œä¸¦ä¸”æœ‰è¨ˆç•«çš„è¿´é¿ç³»çµ±çš„å®‰å…¨æœå‹™ã€‚ 

## æ”»æ“Šç¨®é¡ž Active V.S Passive attack  
### Active Attack ä¸»å‹•å¼æ”»æ“Š  
å…¥ä¾µè€…é‡å°æª”æ¡ˆæˆ–é€šè¨Šå…§å®¹é€²è¡Œå½é€ æˆ–ä¿®æ”¹
ä¸»å‹•å¼æ”»æ“Šæ³• : `å½è£` `é‡æ’­` `è¨Šæ¯ç«„æ”¹` `æœå‹™é˜»çµ•DOS`

### Passive Attack è¢«å‹•å¼æ”»æ“Š  
å…¥ä¾µè€…ç«Šå–è³‡è¨Šï¼Œæˆ–è€…ç›£æŽ§è³‡è¨Šå‚³è¼¸
è¢«å‹•å¼æ”»æ“Šæ³• : `ç«Šè½` `é€šè¨Šåˆ†æž`  

# CH02 ç¶“å…¸çš„åŠ å¯†æ³•  

### åè©žå®šç¾©  
> Plaintext : åŽŸæ–‡
> Ciphertext : å¯†æ–‡
> Cipher : åŠ å¯†æ¼”ç®—æ³•
> Key : é‡‘é‘°
> encipher(decrypt) : åŠ å¯†
> decipher(encrypt) : è§£å¯†
> Crytography : åŠ å¯†å­¸
> Crytanalysis : ç ´è­¯
> Cryptology : å¯†ç¢¼å­¸

## å°ç¨±å¼åŠ å¯† Symmetric Cipher  
![](https://i.imgur.com/NSMYbZO.png =500x)
åŠ è§£å¯†çš„ Key æ˜¯åŒä¸€æŠŠï¼Œä¸¦ä¸”éƒ½ç‚ºå¯†é‘°  

æ¢ä»¶ : 
* å¤ å¼·çš„åŠ å¯†æ¼”ç®—æ³•
* å¯†é‘°åƒ…è¢« Sender / receiver æ‰€çŸ¥ (Secure channel)
* åŠ å¯†æ¼”ç®—æ³•æ˜¯å…¬é–‹çš„
> æ•¸å­¸ä¸Šè¡¨ç¤º :
> Y = E(K, X)
> X = D(K, Y)

### ç ´è­¯æ–¹æ³•  
* Cryptanalytic Attack
åˆ†æžæ˜Žæ–‡ã€å¸¸è¦‹æ–‡æ³•è§£å¯†å¾Œçš„çµæžœä¾†è§£æžåŠ å¯†æ¼”ç®—æ³•
* Brute-force Attack
æš´åŠ›è§£

> åè©žå®šç¾©  
> **Unconditional security** : ä¸ç®¡çµ¦å¤šä¹…çš„æ™‚é–“ã€å¤šå°‘çš„é‹ç®—èƒ½ï¼Œéƒ½ä¸å¯èƒ½è¢«ç ´è§£
> **Computational security** : åœ¨æœ‰é™ç®—åŠ›ä¸‹ä¸èƒ½è¢«ç ´è§£

### å¤å…¸åŠ å¯†æ³•  

### å‡±è–©åŠ å¯†æ³• Caesar Cipher  
ç‚º Shift åŠ å¯†æ³•çš„ä¸€ç¨®ï¼Œä»¥ Key ä½œç‚ºä½ç§»ä½å…ƒæ•¸ï¼Œå¾€ä¸‹ç§»å‹•ä½å…ƒ  
ç ´è­¯åƒ…éœ€å˜—è©¦ `26` ç¨®çµ„åˆ  
ex :   
```
åŽŸæ–‡ abcdez
Key 3
å¯†æ–‡ defghc
```  

#### ç ´è§£æ–¹æ³• :  
1. æš´åŠ›è§£ï¼Œå› è‹±æ–‡å­—æ¯åƒ…æœ‰ 26 å€‹ï¼Œæ‰€ä»¥å¹³å‡å˜—è©¦ 13 æ¬¡å³å¯å¾—åˆ°åŽŸæ–‡  
2. å­—é »åˆ†æžï¼Œåˆ†æžè‹±æ–‡å¸¸è¦‹å­—æ¯çš„ä½å…ƒå·®ï¼ŒåŽ»åšåä½ç§»  

### Monoalphabetic Cipher  
å‡±è–©åŠ å¯†æ³•é€²éšŽç‰ˆæœ¬ï¼Œè®“æ¯å€‹å­—æ¯éƒ½åšä¸€å€‹ä¸€å°ä¸€çš„æ˜ å°„ï¼ŒA å°æ‡‰åˆ° Cï¼ŒB å°æ‡‰åˆ° Z ç­‰ï¼Œè€Œä¸æ˜¯ä½ç§»å…±åŒçš„é•·åº¦ã€‚  
ç ´è­¯é›£åº¦æå‡è‡³ `26!` ç¨®çµ„åˆ  
ex :  
```
åŽŸæ–‡ ABCDEFGHIJKLMNOPQRSTUVWXYZ
é‡‘é‘° DKVQFIBJWPESCXHTMYAUOLRGZN
å¯†æ–‡ DKVQFIBJWPESCXHTMYAUOLRGZN
```  

#### ç ´è§£æ–¹æ³• :  
1. å­—é »åˆ†æžï¼Œåˆ†æžè‹±æ–‡å¸¸è¦‹å­—æ¯çš„ä½å…ƒå·®ï¼ŒåŽ»åšåä½ç§»  

### Playfair Cipher  
1. åšä¸€å€‹5*5çš„è¡¨æ ¼
2. ä¾åºå°‡ Key å¡«å…¥ï¼Œé‡è¤‡çš„å­—æ¯è·³éŽã€‚å› ç‚ºå­—æ¯æœ‰26å€‹ï¼Œé€šå¸¸å°‡ `I / J` è¦–ç‚ºåŒä¸€å€‹å­—ã€‚
3. å¡«å®ŒKeyçš„å­—æ¯å¾Œï¼Œå°‡æ²’å‡ºç¾éŽçš„å­—æ¯ä¾åºå¡«å®Œã€‚
4. é–‹å§‹åŠ å¯†ï¼Œå°‡æ˜Žæ–‡å…©å€‹å…©å€‹å­—ä¸€çµ„ï¼Œå¦‚æžœ
    * å…©å€‹å­—æ¯å‡ºç¾åœ¨åŒä¸€ `Row`ï¼Œè½‰æ›ç‚ºå³é‚Šä¸€æ ¼çš„å­—æ¯ã€‚  
    * å…©å€‹å­—æ¯å‡ºç¾åœ¨åŒä¸€ `Column`ï¼Œè½‰æ›ç‚ºä¸‹é¢ä¸€å€‹çš„å­—æ¯ã€‚  
    * å…¶ä»–ï¼Œå‰‡æ‰¾å‡ºå¦å¤–å…©æ ¼ä½¿è©²å››å€‹å­—æ¯å½¢æˆä¸€å€‹çŸ©å½¢ã€‚ (ç¬¬ä¸€å€‹å­—æ¯æ‰¾åŒ`Row`ï¼Œç¬¬äºŒå€‹å­—æ¯æ‰¾åŒ`Column`)  
    * å¦‚æžœå…©å€‹å­—æ¯ä¸€æ¨£ã€æˆ–æ˜¯æœ€å¾Œåªå‰©ä¸€å€‹å­—ï¼Œæ’å…¥/è£œä¸Šå­—æ¯Xã€‚  
```  
åŽŸæ–‡ DA RE TO CO ME DO WN IC EB IR D
é‡‘é‘° PLAYFAIR
å¯†æ–‡ BF IG NQ RS EG RT UQ RD HI RB CZ
```  
|P   |L|A|Y|F|
|----|-|-|-|-|
|I(J)|R|B|C|D|
|E   |G|H|K|M|
|N   |O|Q|S|T|
|U   |V|W|X|Z|

### VigenÃ¨re Cipher  
é¡žä¼¼å‡±è–©åŠ å¯†ï¼Œå°‡ KEY é‡è¤‡è¤‡è£½ç›´åˆ°ç­‰æ–¼åŽŸæ–‡é•·åº¦ï¼Œå†åšç›¸åŠ å¾—åˆ°å¯†æ–‡  

`åŽŸæ–‡ ` IFEELLIKEPATRICKSAGENIUSANDHESJUSTTROLLING  
`é‡‘é‘° ` PATRICK  
`å¯†é‘°2` PATRICK**PATRICKPATRICKPATRICKPATRICKPATRICK**  
`å¯†æ–‡ ` XFXVTNSZEIRBTSRKLROGXXULRVFRTSCLAVDGOECQPQ  
* ç‰¹é»ž  
å¦‚æžœKeyçš„é•·åº¦è¢«å¾—çŸ¥ï¼Œè¢«ç ´è§£çš„å¯èƒ½æ€§æœƒå¤§å¹…ä¸Šå‡ã€‚  

### Autokey Cipher  
èˆ‡ VigenÃ¨re Cipher é¡žä¼¼ï¼Œåªæ˜¯ KEY å¾Œé¢æ˜¯å°‡åŽŸæ–‡æ”¾å…¥è£œå……é•·åº¦  

`åŽŸæ–‡ ` IFEELLIKEPATRICKSAGENIUSANDHESJUSTTROLLING  
`é‡‘é‘° ` PATRICK  
`å¯†é‘°2` PATRICK**IFEELLIKEPATRICKSAGENIUSANDHESJUSTT**  
`å¯†æ–‡ ` XFXVTNSSJTEECQMOHAZVVKEKATHUMMBUFWAVGUFAGZ  

### Vernam Cipher  
èˆ‡ VigenÃ¨re Cipher é¡žä¼¼ï¼Œåªæ˜¯é‹ç®—ç”±åŠ æ³•æ”¹ç‚º XORï¼Œæ¯å€‹å­—å…ƒä¾ ABC é †åºè½‰ç‚ºäºŒé€²ä½ 5 bits  
ex : A -> 0, C -> 2  

`åŽŸæ–‡ ` VERNAM  
`é‡‘é‘° ` CIPHER  
`å¯†æ–‡ ` XMGUED  

### One-Time Pad  
èˆ‡ Vernam ä¸€æ¨£ï¼Œç”¨è·Ÿåæ–‡ä¸€æ¨£é•·çš„å¯†ç¢¼æœ¬  

### Rail Fence Cipher  
Key ç‚ºä¸€å€‹æ•¸å­—ï¼Œä»£è¡¨è‘—ç±¬ç¬†çš„ Row æ•¸é‡ï¼Œæ˜Žæ–‡éš¨è‘—ç±¬ç¬†ä¸Šä¸‹ç§»å‹• â†˜â†—â†˜ï¼Œæœ€å¾Œå†ç”±å·¦è€Œå³ï¼Œç”±ä¸Šè€Œä¸‹åˆèµ·ä¾†è®Šæˆå¯†æ–‡ã€‚  

`åŽŸæ–‡ ` RAILFENCE  
`é‡‘é‘° ` 3  
```
R          F           E 
  A     L     E     C   
     I           N
```

`å¯†æ–‡ ` RFEALECIN  

### Row Transposition Ciphers  
å…ˆæŠŠæ˜Žæ–‡ä¾æ“š Key çš„é•·åº¦ä½œç‚ºä¸€ Rowï¼Œä¾åºå»ºæˆä¸€å€‹äºŒç¶­é™£åˆ—ã€‚ä¹‹å¾Œä¾æ“š Key å°‡æ¯ä¸€ Column å–å‡ºå’Œç‚ºå¯†æ–‡  

`åŽŸæ–‡` ROWTRANSPOSITIONCIPHER  
`é‡‘é‘°` 531246  
```
ROWTRA
NSPOSI
TIONCI
PHER
```  

`å¯†æ–‡` WPOETONROSIHRSCRNTPAII  

### Product Ciphers  
åˆå Substitution cipherï¼ŒKEY ç‚ºä¸€ MAPPING è¡¨ï¼Œå°‡ KEY ä½œç‚º Index mapping ä½ç½®  

`åŽŸæ–‡` PRODUCTCIPHER  
`é‡‘é‘°` 13 1 5 7 3 4 6 11 9 10 8 12 2  
`å¯†æ–‡` RPUTODCHIPCER  

### Rotor Machines  
å¤§é‡ç”¨æ–¼äºŒæˆ°æ™‚æœŸçš„å¯¦é«”å¼åŠ è§£å¯†è¨­å‚™ï¼Œç‚ºæ©Ÿæ¢°å¼åŠ å¯†ï¼ŒåŒç‚ºæ›¿æ›ä½å…ƒå¼åŠ å¯†  

# CH03 Block Ciphers and the Data Encryption Standard  

![](https://i.imgur.com/LeKeeNW.png =500x)

### Stream Cipher vs. Block Cipher  
**Stream ciphers** : ä»¥ä½å…ƒç‚ºå–®ä½åŠ å¯†ï¼Œä¸€æ¬¡ä¸€ä½å…ƒï¼Œè¼ƒå°ä¸”å¿«é€Ÿã€‚  
**Block ciphers** : ä»¥å€å¡Šç‚ºå–®ä½åŠ å¯†ï¼Œè¼ƒç‚ºè¢«ç¶²è·¯æ‡‰ç”¨æ‰€ä½¿ç”¨ã€‚  

## Sream Ciphers  
![](https://i.imgur.com/o0diiiT.png)
é€šå¸¸ä»¥ XOR ä½œç‚ºé‹ç®—å…ƒï¼Œä»¥ä¸åŒçš„ S åŽ»èˆ‡åŽŸæ–‡åš XOR ä¾†åŠ å¯†ï¼ŒKey çš„ç”Ÿæˆå¿…é ˆç‚ºéš¨æ©Ÿï¼Œä¸¦åˆ†ç‚º  

> éžåŒæ­¥ : Key ç”Ÿæˆè¦åƒè€ƒä¸Šä¸€å€‹å¯†æ–‡  
> åŒæ­¥ : Key ç”Ÿæˆè¦åƒè€ƒä¸Šä¸€å€‹ Key  

ç›®å‰å› å®‰å…¨æ€§ä»¥åŠæ¼”ç®—æ³•å•é¡Œæ¯”è¼ƒå°‘ç”¨åˆ°  

## Block Ciphers  
ä»¥å›ºå®šé•·åº¦çš„å€å¡Š (64 bits) ä½œç‚ºå–®ä½åŠ å¯†ï¼Œè€Œç›®å‰ä½¿ç”¨å°ç¨±å¼åŠ å¯†çš„ Block cipher åŠ å¯†æ³•å¤šç‚º ==Feistel Cipher Structure==  

### Block Cipher åŽŸå§‹è¦ç´   
* Confusion å›°æƒ‘  
è¤‡é›œåŒ–å¯†æ–‡èˆ‡ Key ä¹‹é–“çš„é—œä¿‚  
* Diffusion æ“´æ•£  
å°‡åŽŸæ–‡çš„å…ƒç´ æ“´æ•£åˆ°æ•´å€‹å¯†æ–‡ä¹‹ä¸­ï¼Œä½¿çš„çµ±è¨ˆçµæ§‹è¢«æ¶ˆé™¤ã€‚  
ä¸€å€‹ bit çš„è®ŠåŒ–å¯èƒ½å°±ä½¿å¯†æ–‡æœ‰è‘—æˆªç„¶ä¸åŒçš„æ¨£å¼  

## DES   
> Block size = 64 bits  
> Key size = 64bits, å¯¦éš›ä½¿ç”¨ 56 bits  
> 16æ¬¡è¿­ä»£  
> Feistel cipher çš„ä¸€ç¨® (å°ç¨±å¼åŠ å¯†çµæ§‹)  

![](https://i.imgur.com/KINoh68.png =400x)


#### Permutation  
å°‡æ•´å€‹é™£åˆ—ä¾æ“š Table è£¡çš„ Index åŽ»ç½®æ›é †åº  
```c++
ex : 
array = ABCDE
Table = [ 2, 3, 5, 4, 1]
Result = BCEDA
```

### F-Function  
![](https://i.imgur.com/yEmfsrW.png =400x)
è¼¸å…¥ 32 bitsï¼Œå…ˆå°‡ 32 bit é€éŽ expansion table æ“´å±•åˆ° 48 bitsï¼Œå†ä¾†èˆ‡ subkey çš„ 48 bits åš XORï¼Œå†ä¾†æ¯ 6 ä½å…ƒç‚ºä¸€çµ„é€²å…¥ S-Boxã€‚  
ä¾æ“šä½å…ƒä½œç‚º Indexï¼Œåˆ°é™£åˆ—ä¸­æ‰¾å‡ºå°æ‡‰çš„å€¼  

`ex` : **0**1001**1**~(2)~  
`value` = S_Box[**01**][1001] = 6 = 0110~(2)~  

![](https://i.imgur.com/WqFtKc4.png =400x)  


æœ€å¾Œå°‡ S-Box å‡ºä¾†çš„å€¼åš Permutationï¼Œå¾—åˆ° 32 bits çš„çµæžœã€‚  

### Subkey  
![](https://i.imgur.com/GBc8DLC.png =400x)  
å°‡ Key å…ˆåš PC1 (Permutation Choice 1)å¾—åˆ° 56 bits çš„è³‡æ–™å¾Œï¼Œåˆ†ç‚ºå…©éƒ¨åˆ† C0 / D0ã€‚  
C0 / D0 åˆ†åˆ¥åšå·¦ç§»ä¸¦å†åšä¸€æ¬¡ PC2 å¾—åˆ° Subkeyã€‚  
æŽ¥ä¸‹ä¾†æŒçºŒå·¦ç§»ï¼Œå†åš PC2ï¼Œç¸½å…± 16 æ¬¡çš„è¿­ä»£ã€‚  

### è§£å¯†  
è§£å¯†æ­¥é©Ÿå¹¾ä¹Žèˆ‡åŠ å¯†ç›¸åŒï¼Œåƒ… Subkey é ˆå€’éŽä¾†ä½¿ç”¨
ex : subkey[15] â†’ subkey[14] ... subkey[0]  

# CH04 Basic Concepts in Number Theory and Finite Fields  

### Divisors é™¤æ•¸ / å› æ•¸  
A å¦‚èƒ½è¢« B æ•´é™¤ï¼Œå‰‡ç¨± B ç‚º A çš„ Divisor
å¯«åš `B | A`  

$ð‘Ž|1$ â†’ then $ð‘Ž=Â±1$  
$ð‘Ž|ð‘$ and $ð‘|ð‘Ž$ â†’ then $ð‘Ž=Â±ð‘$  

### Residue é¤˜æ•¸  

### Greatest Common Divisor (GCD æœ€å¤§å…¬å› æ•¸)  
A èˆ‡ B æœ‰è‘—å…±åŒé™¤æ•¸ Cï¼Œè€Œæœ€å¤§çš„ C å‰‡ç‚º GCDã€‚  
> å¦‚å…©æ•¸é™¤äº† 1 ç„¡å…¶ä»–é™¤æ•¸ï¼Œå‰‡å…©æ•¸äº’è³ª (relatively prime)  

* ç®—æ³•  
  $gcd(a, b) = gcd(b, a\bmod b)$  
  
### Modular Arithmetic æ¨¡ç®—æ•¸  
:::info
é¤˜æ•¸å¿…ç‚ºæ­£
:::  
* module operator æ¨¡é‹ç®—  
  $a \bmod b = c$  
  $a = b*int + c$  
* congruent module åŒé¤˜  
  if $ð‘Ž \bmod ð‘› = ð‘ \bmod ð‘›$  
  $a â‰¡ b \bmod n$  
* æ¨¡é‹ç®—ç”¢ç”Ÿçš„é›†åˆ  
  $Z_n = \{0, 1, ..., n-1\}$  

#### Modular Arithmetic Operations æ¨¡é‹ç®—å…ƒ  
$(a + b) \bmod n = [(a \bmod n) + (b \bmod n)] \bmod n$  
$(a - b) \bmod n = [(a \bmod n) - (b \bmod n)] \bmod n$  
$(a Ã— b) \bmod n = [(a \bmod n) * (b \bmod n)] \bmod n$  

### Additive Inverse åŠ æ³•åå…ƒç´   
å°æ–¼ä¸€å€‹ä»»æ„æ•¸ nï¼Œå­˜åœ¨åŠ æ³•åå…ƒç´ ï¼Œå…¶èˆ‡åŠ æ³•åå…ƒç´ ä¹‹å’Œåœ¨ mod n ä¸‹èˆ‡ 0 åŒé¤˜
$a + b â‰¡ 0 \bmod n$  
$b$ ç‚º $a$ çš„åŠ æ³•åå…ƒç´   
```
ex : åˆ—å‡º Zn ,n=10ä¹‹åŠ æ³•åå…ƒç´ çš„æ•¸å°
(0,0)ã€(1,9)ã€(2,8)ã€(3,7)ã€(4,6)ã€(5,5)
```
> å°æ–¼æ•´æ•¸ a ä¾†èªªï¼Œ-a ç‚º a çš„åŠ æ³•åå…ƒç´   

### Multiplicative Inverse ä¹˜æ³•åå…ƒç´   
å°æ–¼ä¸€å€‹ä»»æ„æ•´æ•¸ $a$ï¼Œ**ä¸ä¸€å®š**å­˜åœ¨ä¹˜æ³•åå…ƒç´ ï¼Œ$a$ èˆ‡å…¶ä¹˜æ³•åå…ƒç´  $b$ ä¹‹ç©åœ¨ $\mod n$ ä¸‹èˆ‡ $1$ åŒé¤˜
$a * b â‰¡ 1 \bmod n$  
```
ex : åˆ—å‡º Zn ä¹‹ä¹˜æ³•åå…ƒç´ çš„æ•¸å°
(1,1)ã€(2,6)ã€(3,4)ã€(5,9)ã€(7,8)ã€(10,10)
```
### Extended GCD Algorithm   
å·²çŸ¥æ•´æ•¸ $a$ $b$ï¼Œextended GCD å¯æ±‚å¾—å…¶ GCD çš„åŒæ™‚æ‰¾åˆ°æ•´æ•¸ $x$ $y$ï¼ˆå…¶ä¸­ä¸€å€‹å¾ˆå¯èƒ½æ˜¯è² æ•¸ï¼‰ï¼Œä½¿å®ƒå€‘æ»¿è¶³
$ax + by = gcd(a, b)$  

ex : $a = 100, b = 35$  
$100 = 35 Ã— 2 + 30$  
$35 = 30 Ã— 1 + 5$  

$30 = 100 - 35 Ã— 2$  
$5 = 35 - 30 Ã— 1$  

$5 = 35 - (100 - 35 Ã— 2)$  
$5 = -100 + 35 Ã— 3$  
`ans` $a = -1, b = 3$  

---

#### æ•¸è«–åè©ž  
> Z - æ‰€æœ‰æ•´æ•¸ $\{...-2, -1, 0, 1, 2...\}$  
> Z~n~ - å°æ–¼ n çš„éžè² æ•´æ•¸ $\{0, 1, 2..., n-1\}$  
> Z~n~^*^ - å°æ–¼ n çš„æ­£æ•´æ•¸ $\{1, 2..., n-1\}$  
> N - éžè² æ•´æ•¸ $\{0, 1, 2...\}$  
> P - æ­£æ•´æ•¸ $\{1, 2...\}$  
> Q - æœ‰ç†æ•¸  
> R - å¯¦æ•¸  
> C - è¤‡æ•¸  
> Q^*^, R^*^, C^*^ - éžè² XX  

### Group   
ç¾¤ $(G, Â·)$ æ˜¯ç”±ä¸€å€‹é›†åˆ $G$ ä»¥åŠä¸€å€‹äºŒå…ƒé‹ç®—å…ƒ $Â·$ æ‰€çµ„æˆçš„ä»£æ•¸çµæ§‹ï¼Œå¿…é ˆç¬¦åˆä»¥ä¸‹å››é»ž  
1. å°é–‰æ€§  
 	å°æ–¼æ‰€æœ‰ $G$ ä¸­çš„ $a, b$ï¼Œé‹ç®— $aÂ·b$ çš„çµæžœä¹Ÿåœ¨ $G$ ä¸­  
3. çµåˆçŽ‡  
    å°æ–¼æ‰€æœ‰ $G$ ä¸­çš„ $a, b, c$ï¼Œç­‰å¼ $(aÂ·b)Â·c = aÂ· (bÂ·c)$ æˆç«‹  
5. å–®ä½å…ƒç´   
    å­˜åœ¨ $G$ ä¸­çš„ä¸€å€‹å…ƒç´  $e$ï¼Œä½¿å¾—å°æ–¼æ‰€æœ‰ $G$ ä¸­çš„å…ƒç´  $a$ï¼Œç¸½æœ‰ç­‰å¼ $eÂ·a = aÂ·e = a$ æˆç«‹  
7. åå…ƒç´   
    å°æ–¼æ¯å€‹ $G$ ä¸­çš„ $a$ï¼Œå­˜åœ¨ $G$ ä¸­çš„ä¸€å€‹å…ƒç´  $b$ ä½¿å¾—ç¸½æœ‰ $aÂ·b = bÂ·a = e$ï¼Œæ­¤è™• $e$ ç‚ºå–®ä½å…ƒç´   
    
```
ex :
(Z7, +) = {0, 1, 2, 3, 4, 5, 6}
ä¸ç¬¦åˆï¼Œå› æœªå°é–‰ (åŠ æ³•æœƒè¶…å‡º 7)
```
> abeliangroup äº¤æ›ç¾¤ : $aï¼Žb = bï¼Ža$  
    
### Cyclic Group å¾ªç’°ç¾¤  
æŒ‡èƒ½ç”±å–®å€‹å…ƒç´  g é€éŽæ¬¡æ–¹æ‰€ç”Ÿæˆçš„ Group  

ex : $(ð’_7^*,âŠ—)$ is Cyclic ($âŠ—$ ç‚º$\bmod 7$)  
$\{1=3^0, 2=3^2, 3=3^1, 4=3^4, 5=3^5, 6=3^3\}$  

### Ring ç’°  
Ring ç’° $(R, +, Ã—)$ æ˜¯ä¸€å€‹æœ‰è‘—å…©å€‹é‹ç®—å…ƒçš„é›†åˆï¼Œå¿…é ˆç¬¦åˆä»¥ä¸‹å››é»ž  
1. $(ð‘…,+)$ å¿…é ˆæ˜¯ abeliangroup/äº¤æ›ç¾¤  
2. åœ¨ Ã— ä¸‹å¾—å°é–‰ $(a Ã— b âˆˆ R$ for all $a, b âˆˆ R)$  
3. çµåˆçŽ‡  
4. åˆ†é…çŽ‡  


### Field é«”  
Ring $(ð‘…,+,Ã—)$ ä¸­æ¯å€‹ $a âˆˆ R$ éƒ½æœ‰ $a^-1$ (åå…ƒç´ ) å‰‡ç‚º Field  
```
ex : Zp p ç‚ºè³ªæ•¸ï¼Œæ˜¯ Field
```
    
### Finite Fields (Galois)  
Finite field å…§çš„å…ƒç´ å€‹æ•¸å¿…ç‚ºè³ªæ•¸çš„æ¬¡æ–¹  
é€šå¸¸ç®—å®Œå¾Œè¦å† Mod  
æ¨™ç¤ºç‚º $GF(p^n)$  
æ¨™ç¤ºç‚º $GF(p)$   
å‰‡é‹ç®—å®Œå¾Œéƒ½è¦ $Mod(p)$  

### Polynomial Arithmetic  
å¤šé …å¼  
$f(x) = a_nx^n + a_{n-1}x^{n-1}+ ... + a_1x + a_0 = \sum a_ix^i$  

> $f(x) = x^3 + x^2, g(x) = x^2 + x + 1$  
#### Polynomial Arithmetic with Modulo Coefficients  
æœƒè®Šæˆ **polynomial ring**  
ex : mod 2  
$f(x) + g(x) = x^3 + x + 1$  
$f(x) Ã— g(x) = x^5 + x^2$  

$GF(2^3)$ polynomial :   
polynomial ð‘† in the set are $\{0, 1, ð‘¥, ð‘¥+1, ð‘¥^2,ð‘¥^2+1,ð‘¥^2+ð‘¥,ð‘¥^2+ð‘¥+1\}$

#### Polynomial Extended GCD  
$gcd[a(x), b(x)] = ð‘Ž(ð‘¥)ð‘£(ð‘¥)+ð‘(ð‘¥)ð‘¤(ð‘¥)=ð‘‘(ð‘¥)$  

# CH05 AES  
> Block Size = 128 bits  
> Key Size = 128 / 192 / 256 bits  
> **Iterative** cipher  

| Key length | Number of rounds |
| ---------- | ---------------- |
| 128        | 10               |
| 192        | 12               |
| 256        | 14               |

![](https://i.imgur.com/uh59CkB.png =500x)
![](https://i.imgur.com/aWULFdL.png =500x)


AES åŠ å¯†æ˜¯åœ¨ä¸€å€‹ 4X4 çš„çŸ©é™£ä¸Šå®Œæˆ  
![](https://i.imgur.com/RYDrVfy.png =300x)
æ­¤çŸ©é™£åˆç¨±ä½œé«”ï¼ˆStateï¼‰ï¼Œå…¶åˆå€¼ç‚ºä¸€æ˜Žæ–‡å€å¡Šï¼ˆ16 Byteï¼‰ï¼Œè€Œä¾æ“šå¯†é‘°çš„é•·åº¦ä¾†æ±ºå®š Iteration çš„æ¬¡æ•¸ï¼Œä¸€å€‹ Iteration åŒ…å« 4 å€‹æ­¥é©Ÿ :  

1. AddRoundKey  
èˆ‡è©²å›žåˆä¹‹é‡‘é‘°åš XOR é‹ç®—  
2. SubBytes  
å°‡çŸ©é™£å…§çš„å€¼çµ„é€éŽ 8 bits çš„ S-Box åšè½‰æ›ï¼ŒS-box èˆ‡ $GF(2^8)$ ä¸Šçš„ä¹˜æ³•åå…ƒç´ æœ‰é—œã€‚  
è©³ç´°æ˜¯é€™æ¨£  
    ```
    é¿å…ç°¡å–®ä»£æ•¸æ€§è³ªçš„æ”»æ“Šï¼ŒS-boxçµåˆäº†ä¹˜æ³•åå…ƒç´ åŠä¸€å€‹å¯é€†çš„ä»¿å°„è®Šæ›çŸ©é™£å»ºæ§‹è€Œæˆã€‚
    æ­¤å¤–åœ¨å»ºæ§‹S-boxæ™‚ï¼Œåˆ»æ„é¿é–‹äº†å›ºå®šé»žèˆ‡åå›ºå®šé»žï¼Œå³ä»¥S-boxæ›¿æ›ä½å…ƒçµ„çš„çµæžœæœƒç›¸ç•¶æ–¼éŒ¯æŽ’çš„çµæžœã€‚
    ```
3. ShiftRows  
æ¯ä¸€ Row éƒ½å¾€å·¦å¾ªç’°ä½ç§»ä¸€å€‹åç§»é‡  
Row 0 ä¸ç§»å‹•  
Row 1 å·¦ç§» 1  
Row 2 å·¦ç§» 2  
Row 3 å·¦ç§» 3  

    ![](https://i.imgur.com/JhNZGHn.png)
    
4. MixColumns  
æ¯ä¸€ Column é€éŽç·šæ€§è®Šæ›äº’ç›¸çµåˆï¼Œæ¯ä¸€ Column 
![](https://i.imgur.com/p6SPt7p.png)


#### Subkey
![](https://i.imgur.com/xeyfohI.png =400x)


# CH06 Block Cipher Operation  

* Electronic Code Book mode (ECB)  
* Cipher Block Chaining mode (CBC)  
* Output Feedback mode (OFB)  
* Cipher Feedback mode (CFB)  
* Counter mode (CTR)  

### Electronic Code Book mode  
`ECB æ¨¡å¼` çš„é‹ä½œåŽŸç†å°±æ˜¯å°‡æ˜Žæ–‡åˆ‡å‰²æˆå¤šå€‹å€å¡ŠåŠ å¯†è§£å¯†ï¼Œå½¼æ­¤äº’ç›¸ä¸å½±é¤Š  

> å„ªé»ž :   
> ä¸­é–“æœ‰ bit error ä¸¦ä¸æœƒå½±éŸ¿å…¶ä»–å€å¡Š  
> å¯ä»¥å¹³è¡Œè™•ç†  

> ç¼ºé»ž :  
> åŒå€‹æ˜Žæ–‡éƒ½æ˜¯åŒå€‹å¯†æ–‡  

* Substitution Attack  
ç”¨å·²çŸ¥çš„ $x_i â†’ y_i$ mapping åŽ»æŽ¨æ¸¬å‡ºå…¶ä»–è¨Šæ¯ç‚ºä½•   
ex : æ”»æ“Šè€…åŒ¯ $1 çµ¦å—å®³è€…ï¼Œè—‰ä»¥ç²å¾—å¸³æˆ¶è³‡è¨Š  

### Cipher Block Chaining mode  
`CBC æ¨¡å¼` æ‰€æœ‰åŠ å¯†å€å¡Šéƒ½è¢«ç¶åœ¨ä¸€èµ·ï¼Œå¾Œé¢çš„å€å¡Šæœƒåƒè€ƒå‰é¢å€å¡Šçš„å¯†æ–‡åš XOR  

> Initialization vector (IV)  
> ç”¨æ–¼éš¨æ©ŸåŒ–åŠ å¯†ï¼Œå¯è®“åŒå€‹æ˜Žæ–‡å¾—åˆ°ä¸åŒçš„å¯†æ–‡  

![](https://i.imgur.com/VlRB7Rk.png =400x)

* Substitution Attack  
ç•¶ IV åœ¨å¤šæ¬¡åŠ å¯†éƒ½ç”¨åŒå€‹ IV çš„è©±å°±å¯èƒ½è¢«å…¥ä¾µ  

### Cipher Feedback mode  
`CFBæ¨¡å¼` å¯ä»¥èªªæ˜¯ä¸åŒé †åºçš„CBCæ¨¡å¼ç‰ˆæœ¬ã€‚  
åœ¨CFBæ¨¡å¼ï¼Œå‰ä¸€å€‹å¯†æ–‡å€å¡Šæœƒå…ˆç”¨åŠ å¯†æ¼”ç®—æ³•åŠ å¯†ï¼Œæ‰èˆ‡æ˜Žæ–‡å€å¡ŠåšXORé‹ç®—  
![](https://i.imgur.com/RKSbOvc.png =400x)  


### Output Feedback mode  
`OFB æ¨¡å¼` ä¸­ï¼ŒåŠ å¯†æ¼”ç®—æ³•çš„ output æœƒ ==feedback== å›žåŠ å¯†æ¼”ç®—æ³•çš„ inputã€‚  
å¦‚è¦æŒ‡å®šç¬¬å¹¾å€‹ blockï¼Œåƒ…éœ€é‡è¤‡åŠ å¯† IV n-1 æ¬¡å³å¯æ±‚å¾—ã€‚  

![](https://i.imgur.com/FaUtIDY.png =400x)

### Counter mode
`CTR æ¨¡å¼` ä¸­ä½¿ç”¨äº†è¨ˆæ•¸å™¨å–ä»£å‚³éž IVï¼Œç”¨ IV + n èˆ‡é‡‘é‘°åŠ å¯†å¾Œå†èˆ‡æ˜Žæ–‡åš XOR ç”¢ç”Ÿå¯†æ–‡ã€‚  

![](https://i.imgur.com/agMKZEb.png =400x)

> å¯ä»¥å¹³è¡Œé‹ç®—æˆ–å¼æŒ‡å®š Block  

## Exhaustive Key Search  
https://fu-sheng-wang.blogspot.com/2017/07/cryptography10-exhaustive-search-attack.html

# CH07 Pseudorandom Number Generation and Stream Ciphers  
## Random Numbers  

### Pseudorandom Number Generators  
`PRNGs` ä½¿ç”¨ç¢ºå®šæ€§æ¼”ç®—æ³• deterministic algorithmic ç”¢ç”Ÿäº‚æ•¸ï¼ŒéŽç¨‹ä¼¼ä¹Žæ˜¯éš¨æ©Ÿçš„ï¼Œä½†å¯¦éš›ä¸Šä¸¦ä¸æ˜¯ï¼Œå¦‚æžœç¨®å­ç‚ºåŒä¸€å€‹ï¼Œé‚£å¾ŒçºŒçµæžœä¹Ÿæœƒå®Œå…¨ç›¸åŒã€‚  
* ä¸æ˜¯çœŸçš„äº‚æ•¸  
> è¢«ç¨±ä½œ **pseudorandom numbers**  


### Linear Congruential Generator  
ç·šæ€§åŒé¤˜æ–¹æ³• `LOG` ç”¨ç·šæ€§æ–¹æ³•æ±‚å¾—  
$ð‘‹_{ð‘›+1}=(ð‘Žð‘‹_ð‘›+ð‘)\bmod ð‘š$  

### Blum Blum Shub Generator  


# æœŸä¸­è€ƒåˆ†éš”ç·š  

---


# CH08 RSA  

## éžå°ç¨±å¼é‡‘é‘°åŠ å¯† (Asymmetric Cryptography)  

#### åˆ†ç‚ºå…¬é‘°èˆ‡ç§é‘°  
> å…¬é‘°ç”¨ä¾†åŠ å¯†ï¼Œç§é‘°è§£å¯†  

* å„ªé»ž  
    * Key çš„å‚³è¼¸æ–¹ä¾¿è¨±å¤šï¼Œç•¢ç«Ÿå…¬é‘°ä¸éœ€è¦ Secure channel å°±å¯å‚³è¼¸ç°½ç« ï¼Œç¢ºä¿äº†è¨Šæ¯å®Œæ•´æ€§  
* ç¼ºé»ž  
    * è¨ˆç®—é‡å¤§  

> å¯¦éš›ä¸Šçš„åŠ è§£å¯†ç³»çµ±æœƒèžåˆéžå°ç¨±å¼é‡‘é‘°ä»¥åŠå°ç¨±å¼ï¼Œç¨±ç‚º **Hybrid System**  
> ä¸»è¦çš„è¨Šæ¯ç”±å°ç¨±å¼åŠ å¯†è² è²¬ï¼Œé‡‘é‘°ç”±éžå°ç¨±å¼åŠ å¯†è² è²¬ã€‚  

### éžå°ç¨±å¼é‡‘é‘°åŠ å¯†æ¼”ç®—æ³•  
#### ç›®æ¨™ : One way function  
$y = f(x)$ å¾ˆå¥½è¨ˆç®—ï¼Œä½†æ˜¯ $x = f^{-1}(y)$ å¾ˆé›£è¨ˆç®—  

#### æ–¹æ³• :  
* æ•´æ•¸å› æ•¸åˆ†è§£ Factoring integers  
    RSA  
* é›¢æ•£å°æ•¸ Discrete Logarithm  
    Diffie-Hellman, Elgamal, DSA  
    Given $ð‘Ž, ð‘¦$ and $ð‘š$, find $ð‘¥$ such that $ð‘Ž^ð‘¥ = ð‘¦ \bmod ð‘š$
    -â€º Exponentiation $ð‘Ž^ð‘¥$ : easy  
* æ©¢åœ“æ›²ç·š Elliptic Curves (EC)  
    ECDH, ECDSA  

#### é‡‘é‘°é•·åº¦èˆ‡ç ´è­¯é›£åº¦çš„é—œä¿‚  
![](https://i.imgur.com/fF1HRhj.png)

##### åŒé¤˜ $a â‰¡ b (\bmod c)$   
> å¦‚æžœ $a \bmod c$ == $b \bmod c$  
* åŠ æ³•æ€§è³ª  
a â‰¡ b (mod k) ï¼† c â‰¡ d (mod k) <=> a+c = b+d (mod k)  
* ä¹˜æ³•æ€§è³ª  
a â‰¡ b (mod k) ï¼† c â‰¡ d (mod k) <=> ac = bd (mod k)   
a â‰¡ b (mod k) <=> a^n^ â‰¡ b^n^ (mod k)  
a â‰¡ b (mod k) <=> am â‰¡ bm (mod k)  


#### [è²»é¦¬å°å®šç†](https://ithelp.ithome.com.tw/articles/10205906)  
å‡è¨­ $a$ ç‚ºæ•´æ•¸ï¼Œ $p$ ç‚ºè³ªæ•¸ï¼Œä¸” $a, p$ äº’è³ª ( $GCD(a, p) = 1$ )
å‰‡ $a^{p-1}â‰¡1(\bmod p)$  


#### æ­æ‹‰å‡½æ•¸ Eulerâ€™s Phi Function  
$Ï†(n)$ å°æ–¼æˆ–ç­‰æ–¼ $n$ çš„æ­£æ•´æ•¸ä¸­èˆ‡ $n$ äº’è³ªçš„æ•¸ç›®  
> $p$ ç‚ºè³ªæ•¸ï¼Œ $Ï†(p) = p-1$  
> $Ï†(ð‘šð‘›)=Ï†(ð‘š) Ï†(ð‘›)$ for $ð‘š, ð‘›$ äº’è³ª  
> $Ï†(ð‘^ð‘˜)=ð‘^{ð‘˜âˆ’1}(ð‘âˆ’1)$  

#### æ­æ‹‰å®šç† Eulerâ€™s Theorem   
$m, a$ç‚ºæ•´æ•¸ï¼Œ$m, a$äº’è³ª  
$a^{Ï†(m)}â‰¡1(\bmod m)$  

> **æ‡‰ç”¨** : æ±‚ $7^{222}$ çš„å€‹ä½æ•¸  
>7 èˆ‡ 10 äº’è³ªï¼Œæ‰€ä»¥ $7^{Ï†(10)} \bmod 10 = 1$  
$7^{4} \bmod 10 = 1$  
æ‰€ä»¥ $7^{4 * 55 + 2} \bmod 10 = 7^2 \bmod 10 = 9$  

#### ä¸­åœ‹å‰©é¤˜å®šç† CRT  
æ˜¯æ•¸è«–ä¸­çš„ä¸€å€‹é—œæ–¼ä¸€å…ƒç·šæ€§åŒé¤˜æ–¹ç¨‹çµ„çš„å®šç†ï¼Œèªªæ˜Žäº†==ä¸€å…ƒç·šæ€§åŒé¤˜æ–¹ç¨‹çµ„==æœ‰è§£çš„æº–å‰‡ä»¥åŠæ±‚è§£æ–¹æ³•ã€‚  

**EX1.** $xâ‰¡4(\bmod 7)$ ä¸” $xâ‰¡3(\bmod 5)$ ï¼Œæ±‚ $x$  
$$
x = 4 + 7u
$$

$$
4+7u â‰¡ 3 (\bmod 5)
$$

$$
7u â‰¡ -1 (\bmod 5)â‰¡4(\bmod 5)
$$

$$
5u+2u â‰¡ 4 (\bmod 5)
$$

$$
2u â‰¡ 4 (\bmod 5)
$$

$$
u â‰¡2
$$

$$
xâ‰¡4+7Ã—2â‰¡18 (\bmod 7Ã—5)â‰¡18(\bmod 35)
$$

#### Square-and-Multiply  
> åŽŸç†ï¼šå°‡ $a^{2b}$ æ‹†æˆ ${(a^b)}^2$ ç„¶å¾Œä¸€ç›´æ‹†ä¸‹åŽ»  

> ç”¨æ³•ï¼šå‡è¨­è¦ç®— $3^{13}$  
1. $13_{10}=1101_2$  
2. set $Res=1$ï¼Œå¾ž MSB åˆ° LSBã€‚å…ˆå°‡ $Res = Res^2$  
3. å¦‚æžœä½å…ƒç‚º1ï¼Œå‰‡ $Res=ResÃ—13$  
4. Loop 4 æ¬¡å¾Œ $Res$ å³ç‚ºçµæžœ  

é‚£å¯¦éš›è·‘ä¸€æ¬¡  
1. **1ï¼š** $Res=1$ , $Res=Res^2=1^2=1$ , $Res=ResÃ—3=3$  
2. **1ï¼š** $Res=3$ , $Res=Res^2=3^2=9$ , $Res=ResÃ—3=27$  
3. **0ï¼š** $Res=27$ , $Res=Res^2=27^2=729$  
4. **1ï¼š** $Res=729$ , $Res=Res^2=729^2=531441$ , $Res=ResÃ—3=1594323$  

##### è¤‡é›œåº¦ : n+1 bits è¤‡é›œåº¦ç‚º 1.5n  

### è³ªæ•¸æ¸¬è©¦  

#### è²»é¦¬è³ªæ•¸åˆ¤å®šæ³• Fermat Primality-Test  
æœ‰ä¸€å€‹è³ªæ•¸ $p$ éš¨æ©Ÿé¸ä¸€å€‹ $a$, $1â‰¦aâ‰¦p-1$
è¨ˆç®— $bâ‰¡a^{p-1} (\bmod p)$
å‡å¦‚ ==$b$ ä¸ç‚º $1$ å‰‡ $p$ ç‚ºåˆæ•¸==ï¼Œåä¹‹å‰‡==å¯èƒ½==ç‚ºè³ªæ•¸  

#### Miller-Rabin Primality-Test  
å‡è¨­ $p$ ç‚ºä¸€è³ªæ•¸ï¼Œ$p-1$ å¯è¡¨ç¤ºç‚º $2^{s}Ã—d$ã€‚ä¸” $s$ ç‚ºæ­£æ•´æ•¸ã€$d$ ç‚ºå¥‡æ•¸  

å‰‡æ­¤æ•¸å¦‚ç‚ºè³ªæ•¸ï¼Œå°æ–¼ $2â‰¦aâ‰¦p-1$ï¼Œå¿…ç¬¦åˆä»¥ä¸‹å…©æ¢ä»¶ä¹‹ä¸€  
1. $a^dâ‰¡1$  
2. $a^{2^rd}â‰¡-1$  
â€» $r$ ç‚ºæ»¿è¶³ $0â‰¦râ‰¦s-1$ çš„æ•´æ•¸  

æ­¤æ¸¬è©¦åš $n$ éï¼Œå‡ºç¾éŒ¯èª¤çš„æ©ŸçŽ‡ç‚º $ð‘ƒð‘Ÿð‘œð‘(error) â‰¤ 4^{âˆ’ð‘˜}$  

#### AKS  
> èƒ½å¤ åœ¨å¤šé …å¼æ™‚é–“å®Œæˆè³ªæ•¸æ¸¬è©¦  

### æ”»æ“Šæ–¹æ³•èˆ‡ååˆ¶æ–¹æ³•  
* **Analytical attacks**  
ç®—å‡ºçµ„åˆå‡º $n$ çš„ $p, q$  
* **Implementation attacks**  
é€éŽ RSA æ¼”ç®—æ³•åœ¨ç¡¬é«”ä»¥åŠè»Ÿé«”ä¸Šçš„å¯¦ä½œå¼±é»žåŽ»é‡å°æ”»æ“Š  

# CH10 å…¬é–‹å¼é‡‘é‘°åŠ å¯†æ³•  
## Diffieâ€“Hellman key exchange  
https://notes.andywu.tw/2019/%e4%bb%a5%e5%85%ac%e9%96%8b%e7%9a%84%e6%96%b9%e5%bc%8f%e4%ba%a4%e6%8f%9b%e8%b3%87%e8%a8%8a%e7%94%9f%e6%88%90%e5%b0%8d%e7%a8%b1%e5%bc%8f%e9%87%91%e9%91%b0/


![](https://i.imgur.com/yM3P62V.png)  

## Discrete Logarithm Problem (DLP)  
çµ¦ä¸€è³ªæ•¸ $p$ï¼Œä¸€å€‹ç”Ÿæˆå…ƒ $Î±âˆˆZâˆ—p$ï¼Œä¸€å€‹å…ƒç´  $Î²âˆˆZâˆ—p$ ( Zâˆ—p has order n)  
æ±‚ $x$  
æ»¿è¶³ $Î±^xâ‰¡Î²(\bmod p)$    


### ä¸­é–“äººæ”»æ“Š Man in the middle attack  
> [Reference](https://notes.andywu.tw/2019/%e4%bb%a5%e5%85%ac%e9%96%8b%e7%9a%84%e6%96%b9%e5%bc%8f%e4%ba%a4%e6%8f%9b%e8%b3%87%e8%a8%8a%e7%94%9f%e6%88%90%e5%b0%8d%e7%a8%b1%e5%bc%8f%e9%87%91%e9%91%b0/)  

ä½¿ç”¨ `Diffieâ€“Hellman Key Exchange` ç”¢ç”Ÿé‡‘é‘°é›–ç„¶å¯ä»¥é˜²æ­¢ç¬¬ä¸‰æ–¹ç›£è½ï¼Œ
ä½†å¦‚æžœé‡åˆ° ==ä¸­é–“äººæ”»æ“Š== é‚£å°±æ²’è¼’äº†  
å°ç¾Žè‹¥ä»‹å…¥äº†å°æ˜Žèˆ‡å°è¯çš„å°è©±  
ç•¶å°æ˜Žå°‡ $(G^A \bmod P)$ å‚³é€çµ¦å°è¯æ™‚æŠŠè¨Šæ¯çµ¦æ””æˆª   
ä¸¦å‡å†’æˆå°æ˜Žå‚³é€ $(G^C \bmod P)$ çµ¦å°è¯  
(Cæ˜¯å°ç¾Žè‡ªå·±ç”¢ç”Ÿçš„éš¨æ©Ÿæ•¸ï¼ŒåŠ ä¸Šå…¬é–‹çš„Pèˆ‡Gå³å¯ç”¢ç”Ÿ $(G^C \bmod P) )$  
ä¾æ¨£ç•«è‘«è˜†ï¼Œç•¶å°è¯å°‡ $(G^B \bmod P)$ å‚³é€çµ¦å°æ˜Žæ™‚æŠŠè¨Šæ¯æ””æˆª  
ä¸¦å‡å†’æˆå°è¯å‚³é€ $(G^D \bmod P)$ çµ¦å°æ˜Ž  
(Dæ˜¯å°ç¾Žè‡ªå·±ç”¢ç”Ÿçš„éš¨æ©Ÿæ•¸ï¼ŒåŠ ä¸Šå…¬é–‹çš„Pèˆ‡Gå³å¯ç”¢ç”Ÿ $(G^D \bmod P) )$    
å¦‚æ­¤ä¸€ä¾†ï¼Œå°ç¾Žå³æˆç‚ºæ“æœ‰é‡‘é‘°çš„ä¸­é–“äºº  
å¾€å¾Œå¯ä»¥ç¥žä¸çŸ¥é¬¼ä¸è¦ºçš„æŠŠåŠ å¯†è¨Šæ¯ç”¨ç¾æœ‰çš„ $Pã€Gã€Cã€D$ çµ¦è§£å¯†äº†  

# CH11 Hash  
> [å¯åƒè€ƒè³‡æ–™](https://ithelp.ithome.com.tw/articles/10202923)  

* preimage resistance (one way function)  
    $H(x)=z$  
    ä½† $z$ ç„¡æ³•æ‰¾å›ž $x$  
* Collision resistance  
    è¨ˆç®—ä¸Šä¸å¯èƒ½æ‰¾çš„åˆ°ä¸€å€‹ $x_2$ ç¬¦åˆ $H(x_2)=H(x_1)$ ä¸” $x_1â‰ x_2$  

![](https://i.imgur.com/wuUGTE4.png)

> [SH1](http://www.tsnien.idv.tw/Security_WebBook/chap4/4-4%20SHA-1%20%E6%BC%94%E7%AE%97%E6%B3%95.html)  

# CH12 MAC  
> [MAC Wiki](https://zh.wikipedia.org/wiki/%E8%A8%8A%E6%81%AF%E9%91%91%E5%88%A5%E7%A2%BC)  
> [ITHOME](https://ithelp.ithome.com.tw/articles/10188333)  
 
# CH13 DSA
> [DSA](http://morris821028.github.io/2015/06/12/security-notes5/)  